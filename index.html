<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTOPIA X - AI 기반 댄서 캐스팅 에이전시</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css?v=2029">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="css/chat.css">
    
    <!-- Supabase JS Library (Must load before any Supabase code) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Supabase Direct Initialization -->
    <script>
        const SUPABASE_URL = 'https://idfpmynjfkvtcsqcjgnm.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlkZnBteW5qZmt2dGNzcWNqZ25tIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2NzQ2NTgsImV4cCI6MjA4NTI1MDY1OH0.KFmClnG-XuW818uUIMlPW0yQ7UswXvIWh-ipv6z5p4I';

        // 도구(supabase)가 도착했는지 확인하고 연결
        if (typeof supabase !== 'undefined') {
            window.supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            console.log("✅ Supabase Direct Init: Connected!");
        } else {
            console.error("❌ Still no Supabase library!");
        }
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <a href="#hero" class="logo">
                    <img src="images/logo.png" alt="UTOPIA X">
                </a>
                <button class="mobile-menu-toggle" aria-label="Toggle menu">
                    <i class="fas fa-bars"></i>
                </button>
                <ul class="nav-links">
                    <li><a href="#hero">Home</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#dancers">Dancers</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="hero" class="hero">
        <div class="hero-background">
            <div class="gradient-overlay"></div>
        </div>
        <div class="container">
            <div class="hero-content">
                <div class="hero-logo">
                    <img src="https://www.genspark.ai/api/files/s/2ElHBEFL" alt="UTOPIA X Logo">
                </div>
                
                <!-- Infinite Photocard Slider -->
                <div class="photocard-slider-container">
                    <div class="photocard-slider">
                        <div class="photocard-item">
                            <img src="images/photocard-1.jpg" alt="부장님이 캐갑이 행사">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-2.jpg" alt="TANAKA Concert">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-3.jpg" alt="DMZ OPEN Festival">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-4.jpg" alt="Performance Stage">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-5.jpg" alt="스테이키">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-6.jpg" alt="CONECT의왕">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-7.jpg" alt="3D 인체파편">
                        </div>
                        <!-- Duplicate for seamless loop -->
                        <div class="photocard-item">
                            <img src="images/photocard-1.jpg" alt="부장님이 캐갑이 행사">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-2.jpg" alt="TANAKA Concert">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-3.jpg" alt="DMZ OPEN Festival">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-4.jpg" alt="Performance Stage">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-5.jpg" alt="스테이키">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-6.jpg" alt="CONECT의왕">
                        </div>
                        <div class="photocard-item">
                            <img src="images/photocard-7.jpg" alt="3D 인체파편">
                        </div>
                    </div>
                </div>
                
                <h1 class="hero-title">
                    AI 기반 댄서 캐스팅
                    <span class="gradient-text">UTOPIA X</span>
                </h1>
                <p class="hero-subtitle">
                    AI 기반 댄서 매칭 시스템으로<br>
                    당신의 프로젝트에 완벽한 아티스트를 찾아드립니다
                </p>
                
                <!-- CTA Popup Cards -->
                <div class="hero-cta-cards">
                    <div class="cta-card">
                        <div class="cta-badge">클라이언트 전용</div>
                        <h3>댄서 섭외가 필요하시다면?</h3>
                        <p>프로젝트에 맞는 최적의 댄서를 AI가 추천해드립니다</p>
                        <button class="btn btn-large btn-gradient" onclick="alert('🚧 현재 구현 중입니다. 곧 만나요!')">
                            <i class="fas fa-search"></i>
                            댄서 섭외하기
                        </button>
                    </div>
                    <div class="cta-card">
                        <div class="cta-badge">아티스트 전용</div>
                        <h3>빠른 매칭과 어울리는 비즈니스 제공</h3>
                        <p>당신의 재능을 필요로 하는 프로젝트를 찾아드립니다</p>
                        <button class="btn btn-large btn-outline" onclick="alert('🚧 현재 구현 중입니다. 곧 만나요!')">
                            <i class="fas fa-user-plus"></i>
                            아티스트 등록하기
                        </button>
                    </div>
                </div>
                
                <div class="hero-stats">
                    <div class="stat-item">
                        <div class="stat-number">1,200+</div>
                        <div class="stat-label">등록 댄서</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">350+</div>
                        <div class="stat-label">성공 프로젝트</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">98%</div>
                        <div class="stat-label">만족도</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="scroll-indicator">
            <i class="fas fa-chevron-down"></i>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">
                    <span class="gradient-text">UTOPIA X</span> 소개
                </h2>
                <p class="section-subtitle">
                    AI 기반 댄서 캐스팅 플랫폼의 혁신
                </p>
            </div>
            <div class="about-content">
                <div class="about-text">
                    <h3>Google Gemini AI 기반 정밀 매칭</h3>
                    <p>
                        UTOPIA X는 Google Gemini AI를 활용하여 프로젝트 요구사항과 댄서의 특성을 
                        정밀하게 분석합니다. 모든 아티스트는 UTOPIAX 전문팀이 직접 검토하고 검증한 
                        신뢰할 수 있는 프로페셔널입니다.
                    </p>
                    <div class="about-features">
                        <div class="feature-item">
                            <div class="feature-icon" style="color: #9d4edd; font-size: 42px;">
                                <i class="fas fa-brain"></i>
                            </div>
                            <div class="feature-text">
                                <h4>Google Gemini AI</h4>
                                <p>최첨단 AI 기술로 정확한 매칭 제공</p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon" style="color: #9d4edd; font-size: 42px;">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="feature-text">
                                <h4>UTOPIA X 직접 검증</h4>
                                <p>전문팀의 철저한 포트폴리오 검수</p>
                            </div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon" style="color: #9d4edd; font-size: 42px;">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="feature-text">
                                <h4>빠른 캐스팅</h4>
                                <p>평균 1분 이내 최적 후보 제안</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="about-image">
                    <img src="images/ai-technology.jpg" alt="AI Technology" 
                         onerror="this.src='https://placehold.co/450x450/1a1a2e/9d4edd?text=AI+Technology'">
                </div>
            </div>
        </div>
    </section>

    <!-- Portfolio Section -->
    <section id="portfolio" class="portfolio section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">
                    프로젝트 <span class="gradient-text">포트폴리오</span>
                </h2>
                <p class="section-subtitle">
                    글로벌 브랜드와 함께한 성공 사례
                </p>
            </div>
            <div class="portfolio-grid">
                <div class="portfolio-item">
                    <img src="https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=800" alt="K-pop Concert">
                    <div class="portfolio-overlay">
                        <h3>K-POP 콘서트 투어</h3>
                        <p>글로벌 아티스트 백댄서 50명 캐스팅</p>
                    </div>
                </div>
                <div class="portfolio-item">
                    <img src="https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=800" alt="Fashion Show">
                    <div class="portfolio-overlay">
                        <h3>패션 런웨이 쇼</h3>
                        <p>럭셔리 브랜드 시즌 컬렉션</p>
                    </div>
                </div>
                <div class="portfolio-item">
                    <img src="https://images.unsplash.com/photo-1429962714451-bb934ecdc4ec?w=800" alt="TV Commercial">
                    <div class="portfolio-overlay">
                        <h3>TV 광고 캠페인</h3>
                        <p>글로벌 스포츠 브랜드 CF</p>
                    </div>
                </div>
                <div class="portfolio-item">
                    <img src="https://images.unsplash.com/photo-1506157786151-b8491531f063?w=800" alt="Music Festival">
                    <div class="portfolio-overlay">
                        <h3>뮤직 페스티벌</h3>
                        <p>대규모 개막식 퍼포먼스</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section id="testimonials" class="testimonials section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">
                    클라이언트 <span class="gradient-text">후기</span>
                </h2>
                <p class="section-subtitle">
                    AI 캐스팅 시스템을 경험한 고객들의 목소리
                </p>
            </div>
            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-header">
                        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100" alt="Client" class="testimonial-avatar">
                        <div class="testimonial-info">
                            <h4>김태현</h4>
                            <p>광고 프로듀서 | 제일기획</p>
                        </div>
                        <div class="testimonial-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <p class="testimonial-text">
                        "AI 매칭 시스템이 정말 놀라웠습니다. 우리가 원하는 스타일의 댄서를 24시간 만에 찾아주었고, 
                        첫 미팅에서 바로 계약을 진행했습니다. 시간과 비용을 크게 절약할 수 있었어요."
                    </p>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-header">
                        <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=100" alt="Client" class="testimonial-avatar">
                        <div class="testimonial-info">
                            <h4>Sarah Johnson</h4>
                            <p>Music Video Director | USA</p>
                        </div>
                        <div class="testimonial-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <p class="testimonial-text">
                        "유토피아X와 함께 작업하는 것은 정말 매끄러웠습니다. AI 시스템이 우리 뮤직비디오에 필요한 것을 정확히 이해했고, 
                        추천해준 댄서들은 완벽했습니다. 매우 전문적이었어요!"
                    </p>
                </div>
                <div class="testimonial-card dancer-testimonial">
                    <div class="testimonial-header">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100" alt="Dancer" class="testimonial-avatar">
                        <div class="testimonial-info">
                            <h4>박민재</h4>
                            <p>프리랜스 댄서</p>
                        </div>
                        <div class="testimonial-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <p class="testimonial-text">
                        "등록 후 일주일 만에 첫 프로젝트 제안을 받았습니다. 플랫폼이 내 스타일에 맞는 
                        프로젝트만 추천해줘서 오디션 성공률이 훨씬 높아졌어요. 댄서로서 커리어 관리가 정말 편해졌습니다."
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Partners Section (Infinite Slider) -->
    <section id="partners" class="partners section section-alt">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">
                    협력 <span class="gradient-text">브랜드</span>
                </h2>
                <p class="section-subtitle">
                    다양한 파트너사와 함께합니다
                </p>
            </div>
            
            <!-- 협력 브랜드 무한 슬라이더 -->
            <div class="brand-slider-wrapper">
                <div class="brand-slider-track" id="brandSlider">
                    <div class="brand-logo">
                        <img src="/images/brands/samsung_black.png" alt="SAMSUNG">
                    </div>
                    <div class="brand-logo">
                        <img src="/images/brands/seoul_arts.png" alt="서울예술대학">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">
                    문의하기 <span class="gradient-text">Contact</span>
                </h2>
                <p class="section-subtitle">
                    언제든지 문의해주세요. 전문 팀이 도와드립니다.
                </p>
            </div>
            <div class="contact-simple">
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <h4>주소</h4>
                    <p>서울시 마포구</p>
                </div>
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h4>이메일</h4>
                    <p>official@utopiax.kr</p>
                </div>
                <a href="https://www.instagram.com/utopiax.official/" target="_blank" rel="noopener noreferrer" class="contact-card" style="text-decoration: none; color: inherit; cursor: pointer; transition: all 0.3s ease;">
                    <div class="contact-icon">
                        <i class="fab fa-instagram"></i>
                    </div>
                    <h4>Instagram</h4>
                    <p style="color: var(--primary-pink); font-weight: 600;">@utopiax.official</p>
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 15px; background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">UTOPIA X</h3>
                    <p style="margin-bottom: 10px;">AI 기반 댄서 캐스팅 플랫폼</p>
                    <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">
                        <strong>사업자 등록번호:</strong> 778-62-00829
                    </p>
                    <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">
                        <strong>대표:</strong> 김성광
                    </p>
                    <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">
                        <strong>이메일:</strong> <a href="mailto:official@utopiax.kr" style="color: var(--primary-blue); text-decoration: none;">official@utopiax.kr</a>
                    </p>
                    <p style="font-size: 14px; color: var(--text-secondary);">
                        <strong>주소:</strong> 서울시 마포구
                    </p>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h4>회사</h4>
                        <ul>
                            <li><a href="#about">회사 소개</a></li>
                            <li><a href="#portfolio">포트폴리오</a></li>
                            <li><a href="#testimonials">후기</a></li>
                            <li><a href="#contact">문의하기</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>서비스</h4>
                        <ul>
                            <li><a href="#" class="open-modal" data-modal="casting">댄서 섭외</a></li>
                            <li><a href="#" class="open-modal" data-modal="artist">아티스트 등록</a></li>
                            <li><a href="#dancers">추천 댄서</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>법적 고지</h4>
                        <ul>
                            <li><a href="#">개인정보처리방침</a></li>
                            <li><a href="#">이용약관</a></li>
                            <li><a href="#">쿠키 정책</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 UTOPIA X. All rights reserved.</p>
                <p>Made with <i class="fas fa-heart"></i> in Seoul, Korea</p>
                <p style="margin-top: 10px; font-size: 11px; opacity: 0.4;">
                    <a href="admin.html" style="color: var(--text-secondary); text-decoration: none; transition: opacity 0.3s;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.4'">
                        <i class="fas fa-shield-alt"></i> Admin
                    </a>
                </p>
            </div>
        </div>
    </footer>

    <!-- Modal: Login/Signup -->
    <div id="loginModal" class="modal">
        <div class="modal-content modal-sm">
            <button class="modal-close" aria-label="Close">&times;</button>
            <div class="modal-header">
                <h2 id="authModalTitle">UTOPIA X 로그인</h2>
                <p id="authModalSubtitle">이메일로 간편하게 시작하세요</p>
            </div>
            
            <!-- Tab Switcher -->
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="signin">
                    로그인
                </button>
                <button class="auth-tab" data-tab="signup">
                    회원가입
                </button>
            </div>
            
            <!-- Sign In Form -->
            <form id="signInForm" class="modal-form auth-form active">
                <div class="form-group">
                    <label for="signInEmail">이메일 주소 *</label>
                    <input 
                        type="email" 
                        id="signInEmail" 
                        name="email" 
                        placeholder="your@email.com"
                        required
                    >
                </div>
                <div class="form-group">
                    <label for="signInPassword">비밀번호 *</label>
                    <input 
                        type="password" 
                        id="signInPassword" 
                        name="password" 
                        placeholder="••••••••"
                        required
                        minlength="6"
                    >
                </div>
                <button type="submit" class="btn btn-large btn-gradient" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i>
                    로그인
                </button>
            </form>
            
            <!-- Sign Up Form - Step 1: User Type Selection -->
            <div id="signUpStep1" class="modal-form auth-form">
                <div class="signup-step-header" style="text-align: center; margin-bottom: 30px;">
                    <h3 style="font-size: 20px; margin-bottom: 10px;">회원 유형을 선택해주세요</h3>
                    <p style="color: var(--text-secondary); font-size: 14px;">맞춤형 서비스를 제공해드립니다</p>
                </div>
                
                <div class="user-type-cards" style="display: grid; gap: 20px;">
                    <div class="user-type-card" data-type="client" onclick="selectUserType('client')" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(157, 78, 221, 0.1)); border: 2px solid var(--border-color); border-radius: 16px; padding: 30px; cursor: pointer; transition: all 0.3s ease;">
                        <svg width="56" height="56" viewBox="0 0 24 24" fill="none" style="margin-bottom: 15px;">
                            <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19Z" fill="#6366F1"/>
                            <path d="M7 10H9V17H7V10ZM11 7H13V17H11V7ZM15 13H17V17H15V13Z" fill="#9D4EDD"/>
                        </svg>
                        <h4 style="font-size: 20px; font-weight: 700; margin-bottom: 10px; color: var(--text-primary);">클라이언트 (섭외 요청)</h4>
                        <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 15px;">댄서를 섭외하고 싶으신가요?</p>
                        <ul style="text-align: left; font-size: 13px; color: var(--text-secondary); line-height: 1.8;">
                            <li>✓ AI 기반 댄서 매칭</li>
                            <li>✓ 빠른 섭외 요청</li>
                            <li>✓ 프로젝트 관리</li>
                        </ul>
                    </div>
                    
                    <div class="user-type-card" data-type="artist" onclick="selectUserType('artist')" style="background: linear-gradient(135deg, rgba(233, 30, 132, 0.1), rgba(255, 107, 107, 0.1)); border: 2px solid var(--border-color); border-radius: 16px; padding: 30px; cursor: pointer; transition: all 0.3s ease;">
                        <svg width="56" height="56" viewBox="0 0 24 24" fill="none" style="margin-bottom: 15px;">
                            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z" fill="#E91E84"/>
                            <path d="M12 6C8.69 6 6 8.69 6 12C6 15.31 8.69 18 12 18C15.31 18 18 15.31 18 12C18 8.69 15.31 6 12 6ZM12 16C9.79 16 8 14.21 8 12C8 9.79 9.79 8 12 8C14.21 8 16 9.79 16 12C16 14.21 14.21 16 12 16Z" fill="#FF6B6B"/>
                        </svg>
                        <h4 style="font-size: 20px; font-weight: 700; margin-bottom: 10px; color: var(--text-primary);">아티스트 (활동 등록)</h4>
                        <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 15px;">댄서로 활동하고 싶으신가요?</p>
                        <ul style="text-align: left; font-size: 13px; color: var(--text-secondary); line-height: 1.8;">
                            <li>✓ 프로필 등록 및 홍보</li>
                            <li>✓ 섭외 제안 받기</li>
                            <li>✓ 포트폴리오 관리</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Sign Up Form - Step 2: Details -->
            <form id="signUpStep2" class="modal-form auth-form" style="display: none;">
                <div class="signup-step-header" style="text-align: center; margin-bottom: 20px;">
                    <button type="button" onclick="backToStep1()" style="background: none; border: none; color: var(--primary-purple); cursor: pointer; font-size: 14px; margin-bottom: 10px;">
                        <i class="fas fa-arrow-left"></i> 유형 다시 선택
                    </button>
                    <h3 style="font-size: 18px; margin-bottom: 5px;" id="step2Title">회원정보 입력</h3>
                    <p style="color: var(--text-secondary); font-size: 13px;" id="step2Subtitle">기본 정보를 입력해주세요</p>
                </div>
                
                <input type="hidden" id="selectedUserType" name="userType" value="">
                
                <!-- 공통 필드 -->
                <div class="form-group">
                    <label for="signUpEmail">이메일 주소 *</label>
                    <input 
                        type="email" 
                        id="signUpEmail" 
                        name="email" 
                        placeholder="your@email.com"
                        required
                    >
                </div>
                <div class="form-group">
                    <label for="signUpPassword">비밀번호 * (6자 이상)</label>
                    <input 
                        type="password" 
                        id="signUpPassword" 
                        name="password" 
                        placeholder="••••••••"
                        required
                        minlength="6"
                    >
                </div>
                <div class="form-group">
                    <label for="signUpPasswordConfirm">비밀번호 확인 *</label>
                    <input 
                        type="password" 
                        id="signUpPasswordConfirm" 
                        name="passwordConfirm" 
                        placeholder="••••••••"
                        required
                        minlength="6"
                    >
                </div>
                
                <!-- 클라이언트 전용 필드 (필수만) -->
                <div id="clientFields" style="display: none;">
                    <div class="form-group">
                        <label for="clientName">담당자 이름 *</label>
                        <input 
                            type="text" 
                            id="clientName" 
                            name="name" 
                            placeholder="홍길동"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="clientPhone">연락처 * (숫자만 입력)</label>
                        <input 
                            type="tel" 
                            id="clientPhone" 
                            name="phone" 
                            placeholder="01012345678"
                            pattern="[0-9]{10,11}"
                            maxlength="11"
                            required
                            oninput="this.value = this.value.replace(/[^0-9]/g, '')"
                        >
                    </div>
                </div>
                
                <!-- 아티스트 전용 필드 (필수만) -->
                <div id="artistFields" style="display: none;">
                    <div class="form-group">
                        <label for="artistStageName">활동명 *</label>
                        <input 
                            type="text" 
                            id="artistStageName" 
                            name="stageName" 
                            placeholder="예) DJ Koo, B-boy Storm"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="artistPhone">연락처 * (숫자만 입력)</label>
                        <input 
                            type="tel" 
                            id="artistPhone" 
                            name="phone" 
                            placeholder="01012345678"
                            pattern="[0-9]{10,11}"
                            maxlength="11"
                            required
                            oninput="this.value = this.value.replace(/[^0-9]/g, '')"
                        >
                    </div>
                    <p style="font-size: 13px; color: var(--text-secondary); margin-top: 10px;">
                        <i class="fas fa-info-circle"></i> 
                        본명, 장르, 경력 등 추가 정보는 마이페이지에서 입력하실 수 있습니다.
                    </p>
                </div>
                
                <button type="submit" class="btn btn-large btn-gradient" style="width: 100%; margin-top: 10px;">
                    <i class="fas fa-user-plus"></i>
                    회원가입 완료
                </button>
                
                <small class="form-hint" style="text-align: center; display: block; margin-top: 15px;">
                    <i class="fas fa-gift"></i>
                    회원가입 시 10 크레딧이 무료로 지급됩니다!
                </small>
            </form>
            
            <p class="form-note" style="text-align: center; margin-top: 15px; font-size: 12px; color: var(--text-muted);">
                가입 시 <a href="#" style="color: var(--primary-purple);">이용약관</a> 및 
                <a href="#" style="color: var(--primary-purple);">개인정보처리방침</a>에 동의하게 됩니다.
            </p>
        </div>
    </div>

    <!-- Modal: Credit Charge -->
    <div id="creditChargeModal" class="modal">
        <div class="modal-content modal-md">
            <button class="modal-close" aria-label="Close">&times;</button>
            <div class="modal-header">
                <h2>💰 크레딧 충전</h2>
                <p>댄서 연락처 공개 및 채팅에 사용되는 크레딧을 충전하세요</p>
            </div>
            <div class="credit-packages">
                <div class="credit-package">
                    <div class="package-badge">기본</div>
                    <div class="package-credits">10 크레딧</div>
                    <div class="package-price">
                        <span class="price-amount">55,000원</span>
                        <span class="price-unit">/ 5,500원 per C</span>
                    </div>
                    <button class="btn btn-outline btn-purchase" data-package="10" data-price="55000">
                        <i class="fas fa-shopping-cart"></i>
                        충전하기
                    </button>
                </div>
                
                <div class="credit-package popular">
                    <div class="package-badge">인기</div>
                    <div class="package-discount">10% 할인</div>
                    <div class="package-credits">50 크레딧</div>
                    <div class="package-price">
                        <span class="price-original">275,000원</span>
                        <span class="price-amount">247,500원</span>
                        <span class="price-unit">/ 4,950원 per C</span>
                    </div>
                    <button class="btn btn-gradient btn-purchase" data-package="50" data-price="247500">
                        <i class="fas fa-shopping-cart"></i>
                        충전하기
                    </button>
                </div>
                
                <div class="credit-package">
                    <div class="package-badge">추천</div>
                    <div class="package-discount">18% 할인</div>
                    <div class="package-credits">100 크레딧</div>
                    <div class="package-price">
                        <span class="price-original">550,000원</span>
                        <span class="price-amount">451,000원</span>
                        <span class="price-unit">/ 4,510원 per C</span>
                    </div>
                    <button class="btn btn-outline btn-purchase" data-package="100" data-price="451000">
                        <i class="fas fa-shopping-cart"></i>
                        충전하기
                    </button>
                </div>
                
                <div class="credit-package best">
                    <div class="package-badge">최고 혜택</div>
                    <div class="package-discount">27% 할인</div>
                    <div class="package-credits">200 크레딧</div>
                    <div class="package-price">
                        <span class="price-original">1,100,000원</span>
                        <span class="price-amount">803,000원</span>
                        <span class="price-unit">/ 4,015원 per C</span>
                    </div>
                    <button class="btn btn-gradient btn-purchase" data-package="200" data-price="803000">
                        <i class="fas fa-shopping-cart"></i>
                        충전하기
                    </button>
                </div>
            </div>
            <p class="form-note" style="text-align: center; margin-top: 20px; font-size: 13px; color: var(--text-secondary);">
                <i class="fas fa-shield-alt"></i>
                안전한 결제 시스템으로 보호됩니다
            </p>
        </div>
    </div>

    <!-- Modal: Casting Request Form -->
    <div id="castingModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" aria-label="Close">&times;</button>
            <div class="modal-header">
                <h2>댄서 섭외 신청</h2>
                <p>프로젝트 정보를 입력하시면 AI가 최적의 댄서를 추천해드립니다</p>
            </div>
            <form id="castingForm" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalClientName">이름 / Name *</label>
                        <input type="text" id="modalClientName" name="clientName" required>
                    </div>
                    <div class="form-group">
                        <label for="clientEmail">이메일 / Email *</label>
                        <input type="email" id="clientEmail" name="clientEmail" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalClientPhone">연락처 / Phone *</label>
                        <input type="tel" id="modalClientPhone" name="clientPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="eventDate">행사 날짜 / Event Date *</label>
                        <input type="date" id="eventDate" name="eventDate" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="eventType">프로젝트 유형 / Project Type *</label>
                        <select id="eventType" name="eventType" required>
                            <option value="">선택해주세요</option>
                            <option value="popup">팝업스토어 & 브랜드 오픈 / Pop-up Store & Opening</option>
                            <option value="shortform">숏폼 & 바이럴 챌린지 / Short-form & Challenge</option>
                            <option value="idol">아이돌 백업 & 시안댄서 모집 / Idol Backup & Draft Dancer</option>
                            <option value="corporate">기업 행사 & 워크샵 / Corporate Event</option>
                            <option value="festival">대학 & 지역 축제 / Festival</option>
                            <option value="commercial">CF, 광고 & 화보 / Commercial</option>
                            <option value="mv">뮤직비디오 & 방송 / Music Video & Broadcast</option>
                            <option value="other">기타 / Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dancerCount">필요 인원 / Number of Dancers *</label>
                        <input type="number" id="dancerCount" name="dancerCount" min="1" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="budget">예산 (만원) / Budget (KRW 10,000) *</label>
                    <input type="number" id="budget" name="budget" min="100" step="50" required>
                    <small>예: 500만원 = 500</small>
                </div>
                
                <div class="form-group">
                    <label for="aiPrompt">원하시는 댄서 스타일을 자유롭게 설명해주세요 *</label>
                    <textarea id="aiPrompt" name="aiPrompt" rows="5" placeholder="예: 힙합 스타일의 에너지 넘치는 댄서를 찾습니다. 키가 크고 파워풀한 춤을 추는 분들을 선호합니다. 어두운 분위기의 퍼포먼스에 적합한 댄서가 필요합니다." required></textarea>
                    <small>AI가 입력하신 설명을 분석하여 최적의 댄서를 매칭해드립니다</small>
                </div>
                
                <div class="form-group">
                    <label for="message">추가 요청사항 / Additional Message</label>
                    <textarea id="message" name="message" rows="3" placeholder="프로젝트에 대한 추가 설명이나 특별 요구사항을 입력해주세요"></textarea>
                </div>
                
                <!-- AI Loading Indicator -->
                <div id="aiLoadingIndicator" class="ai-loading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>🤖 AI가 요청을 분석하고 최적의 댄서를 찾고 있습니다...</p>
                    <small>잠시만 기다려주세요 (약 3초 소요)</small>
                </div>
                
                <button type="submit" class="btn btn-large btn-gradient btn-submit">
                    <i class="fas fa-robot"></i>
                    AI 매칭 신청하기
                </button>
            </form>
        </div>
    </div>

    <!-- Modal: Artist Registration Form (Simplified) -->
    <div id="artistModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" aria-label="Close">&times;</button>
            <div class="modal-header">
                <h2>아티스트 등록</h2>
                <p>프로필을 등록하고 다양한 프로젝트 기회를 받아보세요</p>
            </div>
            <form id="artistForm" class="modal-form">
                <!-- 📋 기본 정보 & 검증 / Basic Information & Verification -->
                <div class="form-section-title">📋 기본 정보 & 검증 / Basic Information</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="artistFormName">이름 / Name *</label>
                        <input type="text" id="artistFormName" name="artistName" required>
                    </div>
                    <div class="form-group">
                        <label for="artistFormEmail">이메일 / Email *</label>
                        <input type="email" id="artistFormEmail" name="artistEmail" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="artistFormPhone">연락처 / Phone *</label>
                        <input type="tel" id="artistFormPhone" name="artistPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="activityRegion">활동 지역 / Activity Region *</label>
                        <select id="activityRegion" name="activityRegion" required>
                            <option value="">선택해주세요</option>
                            <option value="seoul">서울 / Seoul</option>
                            <option value="gyeonggi">경기 / Gyeonggi</option>
                            <option value="incheon">인천 / Incheon</option>
                            <option value="busan">부산 / Busan</option>
                            <option value="daegu">대구 / Daegu</option>
                            <option value="gwangju">광주 / Gwangju</option>
                            <option value="daejeon">대전 / Daejeon</option>
                            <option value="ulsan">울산 / Ulsan</option>
                            <option value="sejong">세종 / Sejong</option>
                            <option value="gangwon">강원 / Gangwon</option>
                            <option value="chungbuk">충북 / Chungbuk</option>
                            <option value="chungnam">충남 / Chungnam</option>
                            <option value="jeonbuk">전북 / Jeonbuk</option>
                            <option value="jeonnam">전남 / Jeonnam</option>
                            <option value="gyeongbuk">경북 / Gyeongbuk</option>
                            <option value="gyeongnam">경남 / Gyeongnam</option>
                            <option value="jeju">제주 / Jeju</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="portfolioLink">포트폴리오 링크 / Portfolio Link * (Instagram, YouTube 등)</label>
                        <input type="url" id="portfolioLink" name="portfolioLink" placeholder="https://instagram.com/..." required>
                        <small>Instagram, YouTube, 개인 웹사이트 등</small>
                    </div>
                    <div class="form-group">
                        <label for="profilePhoto">프로필 사진 업로드 / Profile Photo *</label>
                        <input type="file" id="profilePhoto" name="profilePhoto" accept="image/*" required>
                        <small>JPG, PNG 형식, 최대 5MB</small>
                    </div>
                </div>

                <!-- 👕 신체 정보 (의상 섭외용) / Physical Information -->
                <div class="form-divider">
                    <span>👕 신체 정보 (의상 섭외용) / Physical Information</span>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="gender">성별 / Gender *</label>
                        <select id="gender" name="gender" required>
                            <option value="">선택해주세요</option>
                            <option value="male">남성 / Male</option>
                            <option value="female">여성 / Female</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="heightCm">키 (cm) / Height *</label>
                        <input type="number" id="heightCm" name="heightCm" min="140" max="210" required placeholder="170">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="weightKg">몸무게 (kg) / Weight *</label>
                        <input type="number" id="weightKg" name="weightKg" min="30" max="150" required placeholder="60">
                    </div>
                    <div class="form-group">
                        <label for="clothingSize">의상 사이즈 / Clothing Size *</label>
                        <select id="clothingSize" name="clothingSize" required>
                            <option value="">선택해주세요</option>
                            <option value="xs">XS</option>
                            <option value="s">S</option>
                            <option value="m">M</option>
                            <option value="l">L</option>
                            <option value="xl">XL</option>
                            <option value="xxl">XXL</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="shoeSize">신발 사이즈 (mm) / Shoe Size *</label>
                        <input type="number" id="shoeSize" name="shoeSize" min="200" max="320" step="5" required placeholder="250">
                        <small>예: 250mm (25.0cm)</small>
                    </div>
                    <div class="form-group">
                        <!-- 빈 공간 -->
                    </div>
                </div>

                <!-- 💰 페이 (Rate) / Payment Rate -->
                <div class="form-divider">
                    <span>💰 페이 (Rate) / Payment Rate</span>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="minimumBudget">최소 섭외 예산 (만원) / Minimum Budget *</label>
                        <input type="number" id="minimumBudget" name="minimumBudget" min="10" step="5" required placeholder="50">
                        <small>예: 50 (50만원)</small>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="negotiable" name="negotiable" value="yes">
                            협의 가능 / Negotiable
                        </label>
                        <small>예산에 따라 협의 가능한 경우 체크하세요</small>
                    </div>
                </div>

                <!-- 💃 댄스 스타일 & AI 매칭 데이터 / Dance Style & AI Matching -->
                <div class="form-divider">
                    <span>💃 댄스 스타일 & AI 매칭 데이터 / Dance Style</span>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="mainGenre">전문 장르 (Main Genre) *</label>
                        <select id="mainGenre" name="mainGenre" multiple size="5" required>
                            <option value="hiphop">힙합 / Hip-hop</option>
                            <option value="kpop">케이팝 / K-pop</option>
                            <option value="contemporary">컨템포러리 / Contemporary</option>
                            <option value="ballet">발레 / Ballet</option>
                            <option value="jazz">재즈 / Jazz</option>
                            <option value="urban">어반 / Urban</option>
                            <option value="breaking">브레이킹 / Breaking</option>
                            <option value="popping">팝핑 / Popping</option>
                            <option value="locking">락킹 / Locking</option>
                            <option value="waacking">왁킹 / Waacking</option>
                            <option value="krump">크럼프 / Krump</option>
                            <option value="house">하우스 / House</option>
                            <option value="voguing">보깅 / Voguing</option>
                            <option value="latin">라틴 / Latin</option>
                            <option value="belly">벨리댄스 / Belly Dance</option>
                        </select>
                        <small>Ctrl/Cmd 키를 눌러 다중 선택 가능</small>
                    </div>
                </div>

                <!-- 이미지/무드 슬라이더 -->
                <div class="form-section-title">🎨 이미지 & 무드 (AI 매칭용) / Image & Mood</div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="freshDark">Fresh ↔ Dark</label>
                        <div class="slider-labels">
                            <span>Fresh</span>
                            <span>Dark</span>
                        </div>
                        <input type="range" id="freshDark" name="freshDark" min="0" max="100" step="10" value="50">
                        <div class="slider-value"><span id="freshDark-value">50</span> / 100</div>
                    </div>
                    <div class="form-group">
                        <label for="powerfulSoft">Powerful ↔ Soft</label>
                        <div class="slider-labels">
                            <span>Powerful</span>
                            <span>Soft</span>
                        </div>
                        <input type="range" id="powerfulSoft" name="powerfulSoft" min="0" max="100" step="10" value="50">
                        <div class="slider-value"><span id="powerfulSoft-value">50</span> / 100</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="standardTrendy">Standard ↔ Trendy</label>
                        <div class="slider-labels">
                            <span>Standard</span>
                            <span>Trendy</span>
                        </div>
                        <input type="range" id="standardTrendy" name="standardTrendy" min="0" max="100" step="10" value="50">
                        <div class="slider-value"><span id="standardTrendy-value">50</span> / 100</div>
                    </div>
                    <div class="form-group">
                        <!-- 빈 공간 -->
                    </div>
                </div>

                <!-- 🌟 특기 사항 (Specialty) / Specialty -->
                <div class="form-divider">
                    <span>🌟 특기 사항 / Specialty</span>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>추가 특기 / Additional Skills</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="actingAvailable" name="actingAvailable"> 연기 가능 / Acting Available</label>
                            <label><input type="checkbox" id="modelingAvailable" name="modelingAvailable"> 모델 활동 가능 / Modeling Available</label>
                            <label><input type="checkbox" id="acrobaticAvailable" name="acrobaticAvailable"> 아크로바틱 / Acrobatic</label>
                            <label><input type="checkbox" id="englishAvailable" name="englishAvailable"> 영어 소통 가능 / English Available</label>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-large btn-gradient btn-submit">
                    <i class="fas fa-check"></i>
                    등록 신청하기
                </button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- AI Match Results Modal -->
    <div id="resultsModal" class="modal">
        <div class="modal-content results-modal-content">
            <button class="modal-close" aria-label="Close" onclick="closeAllModals()">&times;</button>
            <div id="resultsContent" class="results-content">
                <!-- Results will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Authentication System -->
    <script src="js/supabase-auth.js"></script>
    
    <!-- Main Scripts -->
    <script src="js/credit-system.js"></script>
    <script src="js/casting.js"></script>
    <script src="js/main.js"></script>
    
    <!-- Emergency Fix: Direct event binding -->
    <script>
        console.log('🚨 Emergency script loaded');
        
        // Initialize global state if not exists
        if (typeof state === 'undefined') {
            window.state = {
                dancers: [],
                featuredDancers: [],
                isLoading: false,
                aiMatchResults: null,
                currentUser: null
            };
            console.log('✅ Global state initialized');
        }
        
        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initEmergencyFixes);
        } else {
            initEmergencyFixes();
        }
        
        function initEmergencyFixes() {
            console.log('🔧 Initializing emergency fixes...');
            
            // Fix 1: Bind CTA cards (with login check)
            bindCTAEvents();
            
            // Fix 2: Bind user menu
            bindUserMenu();
            
            // Fix 3: Bind navigation login link
            bindNavigationLogin();
            
            // Fix 4: Hide broken images
            hideErrorImages();
            
            // Fix 5: Bind auth forms
            bindAuthForms();
            
            console.log('✅ Emergency fixes ready');
        }
        
        function bindCTAEvents() {
            console.log('🎯 Binding CTA events...');
            
            // Get all CTA cards
            const ctaCards = document.querySelectorAll('.cta-card');
            console.log('📦 Found CTA cards:', ctaCards.length);
            
            ctaCards.forEach((card, index) => {
                const modalType = card.getAttribute('data-modal');
                console.log(`🎯 Card ${index + 1}: ${modalType}`);
                
                // 🚨 FIX: Only bind click to button, NOT to card
                const button = card.querySelector('button');
                if (button) {
                    button.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('🔘 Button clicked:', modalType);
                        handleCTAClick(modalType);
                    });
                    console.log(`✅ Button bound for ${modalType}`);
                }
            });
            
            console.log('✅ CTA events bound');
        }
        
        function handleCTAClick(modalType) {
            // Check if user is logged in
            const isLoggedIn = checkLoginStatus();
            const userType = sessionStorage.getItem('userType');
            const userRole = sessionStorage.getItem('userRole');
            
            console.log('🎯 CTA Click:', { modalType, isLoggedIn, userType, userRole });
            
            // 🆕 Artist registration - redirect to dedicated page
            if (modalType === 'artist') {
                if (!isLoggedIn) {
                    console.log('⚠️ User not logged in for artist registration');
                    showToast('먼저 로그인해주세요 🔐', 'info');
                    setTimeout(() => {
                        openModalDirect('login');
                    }, 500);
                    return;
                }
                
                if (userType === 'client' || userRole === 'client') {
                    console.log('❌ Client trying to access artist registration');
                    showToast('❌ 아티스트 프로필 등록은 아티스트 계정만 가능합니다', 'error');
                    return;
                }
                
                // Redirect to artist registration page
                console.log('✅ Redirecting to artist-register.html');
                window.location.href = 'artist-register.html';
                return;
            }
            
            // Casting request - show modal
            if (modalType === 'casting') {
                if (!isLoggedIn) {
                    console.log('⚠️ User not logged in for casting');
                    showToast('먼저 로그인해주세요 🔐', 'info');
                    setTimeout(() => {
                        openModalDirect('login');
                    }, 500);
                    return;
                }
                
                if (userType === 'artist' || userRole === 'artist') {
                    console.log('❌ Artist trying to access casting');
                    showToast('❌ 댄서 섭외는 클라이언트 계정만 가능합니다', 'error');
                    return;
                }
            }
            
            openModalDirect(modalType);
        }
        
        function checkLoginStatus() {
            // Check if state.currentUser exists (from main.js)
            if (typeof state !== 'undefined' && state.currentUser) {
                return true;
            }
            
            // Check session storage
            const userEmail = sessionStorage.getItem('userEmail');
            const userEmailDisplay = document.getElementById('userEmailDisplay');
            
            if (userEmail && userEmail !== 'Login') {
                if (userEmailDisplay) {
                    userEmailDisplay.textContent = userEmail;
                }
                return true;
            }
            
            return false;
        }
        
        function showToast(message, type = 'info') {
            console.log('📢 Toast:', message, type);
            
            const toast = document.getElementById('toast');
            if (toast) {
                toast.textContent = message;
                toast.className = `toast ${type} show`;
                
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            } else {
                // Fallback: create toast if not exists
                const newToast = document.createElement('div');
                newToast.id = 'toast';
                newToast.className = `toast ${type} show`;
                newToast.textContent = message;
                document.body.appendChild(newToast);
                
                setTimeout(() => {
                    newToast.classList.remove('show');
                }, 3000);
            }
        }
        
        function bindUserMenu() {
            console.log('👤 Binding user menu...');
            
            const userMenuBtn = document.getElementById('userMenuBtn');
            const userMenuDropdown = document.getElementById('userMenuDropdown');
            
            if (userMenuBtn && userMenuDropdown) {
                userMenuBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    console.log('🖱️ User menu clicked');
                    
                    // Check if logged in
                    const isLoggedIn = checkLoginStatus();
                    if (!isLoggedIn) {
                        console.log('⚠️ Not logged in, opening login modal');
                        openModalDirect('login');
                    } else {
                        userMenuDropdown.classList.toggle('active');
                    }
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!userMenuBtn.contains(e.target) && !userMenuDropdown.contains(e.target)) {
                        userMenuDropdown.classList.remove('active');
                    }
                });
                
                // Bind "로그아웃" to logout
                const btnLogout = document.getElementById('btnLogout');
                if (btnLogout) {
                    btnLogout.addEventListener('click', function(e) {
                        e.preventDefault();
                        console.log('👋 Logout clicked');
                        
                        // Clear session
                        sessionStorage.removeItem('userEmail');
                        if (typeof state !== 'undefined') {
                            state.currentUser = null;
                        }
                        
                        // Update UI
                        const userEmailDisplay = document.getElementById('userEmailDisplay');
                        if (userEmailDisplay) {
                            userEmailDisplay.textContent = 'Guest';
                        }
                        
                        userMenuDropdown.classList.remove('active');
                        showToast('로그아웃되었습니다', 'success');
                    });
                }
                
                console.log('✅ User menu bound');
            } else {
                console.warn('❌ User menu elements not found');
            }
        }
        
        function bindNavigationLogin() {
            console.log('🔗 Binding navigation login link...');
            
            // Find all links that should open login modal
            const loginLinks = document.querySelectorAll('a[href="#login"], .open-modal[data-modal="login"]');
            console.log('📦 Found login links:', loginLinks.length);
            
            loginLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('🔓 Login link clicked');
                    openModalDirect('login');
                });
            });
            
            console.log('✅ Navigation login bound');
        }
        
        function hideErrorImages() {
            console.log('🖼️ Hiding error images...');
            
            // Find all images with via.placeholder.com
            const placeholderImages = document.querySelectorAll('img[src*="via.placeholder.com"]');
            console.log('📦 Found placeholder images:', placeholderImages.length);
            
            placeholderImages.forEach(img => {
                // Hide the parent container
                const parent = img.closest('.client-logo');
                if (parent) {
                    parent.style.display = 'none';
                }
                
                // Also hide on error
                img.addEventListener('error', function() {
                    const parent = this.closest('.client-logo');
                    if (parent) {
                        parent.style.display = 'none';
                    }
                });
            });
            
            console.log('✅ Error images hidden');
        }
        
        function openModalDirect(type) {
            console.log('🚀 Opening modal:', type);
            
            // Close all modals first
            document.querySelectorAll('.modal').forEach(m => {
                m.classList.remove('active');
            });
            
            // Map modal types to IDs
            const modalIds = {
                'casting': 'castingModal',
                'artist': 'artistModal',
                'login': 'loginModal'
            };
            
            const modalId = modalIds[type];
            const modal = document.getElementById(modalId);
            
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                console.log('✅ Modal opened:', modalId);
            } else {
                console.error('❌ Modal not found:', modalId);
            }
        }
        
        // Close modal function
        window.closeAllModals = function() {
            console.log('🔒 Closing all modals');
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
            document.body.style.overflow = '';
        };
        
        // Bind close buttons
        document.querySelectorAll('.modal-close').forEach(btn => {
            btn.addEventListener('click', closeAllModals);
        });
        
        // ❌ 바깥 클릭으로 모달 닫기 제거
        // ❌ ESC 키로 모달 닫기 제거
        // → X 버튼으로만 닫을 수 있음
        
        // Authentication Forms Handler
        function bindAuthForms() {
            console.log('🔐 Binding auth forms...');
            
            // Sign In Form - Don't clone, just remove old listeners
            const signInForm = document.getElementById('signInForm');
            console.log('📝 SignIn form found:', !!signInForm);
            
            if (signInForm) {
                // Create new handler
                const handleSignIn = async function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🔓 Sign in form submitted');
                    
                    const email = document.getElementById('signInEmail').value;
                    const password = document.getElementById('signInPassword').value;
                    
                    console.log('🔐 Login attempt:');
                    console.log('  - Email:', email);
                    console.log('  - Password length:', password.length);
                    
                    // Validate
                    if (!email || !password) {
                        console.error('❌ Missing email or password');
                        showToast('이메일과 비밀번호를 입력해주세요', 'error');
                        return;
                    }
                    
                    if (password.length < 6) {
                        console.error('❌ Password too short');
                        showToast('비밀번호를 6자 이상 입력해주세요', 'error');
                        return;
                    }
                    
                    // Check if auth functions are available
                    if (typeof signIn === 'function') {
                        console.log('✅ signIn function available, calling...');
                        try {
                            const result = await signIn(email, password);
                            console.log('🔓 Login result:', result);
                            
                            if (result.success) {
                                console.log('✅ Login successful, closing modal');
                                closeAllModals();
                            } else {
                                console.error('❌ Login failed:', result);
                            }
                        } catch (error) {
                            console.error('❌ Login exception:', error);
                            showToast('로그인 중 오류가 발생했습니다', 'error');
                        }
                    } else {
                        console.error('❌ signIn function not available');
                        showToast('인증 시스템을 사용할 수 없습니다', 'error');
                    }
                };
                
                // Remove old event listeners by replacing with clone
                const newSignInForm = signInForm.cloneNode(true);
                signInForm.parentNode.replaceChild(newSignInForm, signInForm);
                
                // Add event listener to new form
                newSignInForm.addEventListener('submit', handleSignIn, false);
                
                // Also add click handler to button
                const signInButton = newSignInForm.querySelector('button[type="submit"]');
                if (signInButton) {
                    console.log('🔘 Binding click event to login button');
                    signInButton.addEventListener('click', function(e) {
                        console.log('🖱️ Login button clicked directly');
                    }, false);
                }
                
                console.log('✅ Sign in form handler attached');
            }
            
            // Sign Up Form - Wait for main.js to fully load
            const signUpForm = document.getElementById('signUpForm');
            console.log('📝 SignUp form found:', !!signUpForm);
            
            // Ensure all scripts are loaded before calling initSignUpForm
            const waitForMainJS = setInterval(() => {
                if (typeof window.initSignUpForm === 'function') {
                    clearInterval(waitForMainJS);
                    window.initSignUpForm();
                    console.log('✅ initSignUpForm called successfully');
                }
            }, 100);  // Check every 100ms until loaded
            
            // Timeout after 5 seconds
            setTimeout(() => {
                clearInterval(waitForMainJS);
                if (typeof window.initSignUpForm !== 'function') {
                    console.error('❌ initSignUpForm failed to load after 5 seconds');
                }
            }, 5000);
            
            console.log('✅ Auth forms bound');
        }
        
        // Switch between sign in and sign up tabs
        window.switchAuthTab = function(tab) {
            console.log('🔄 Switching to tab:', tab);
            
            const signInTab = document.querySelector('.auth-tab[data-tab="signin"]');
            const signUpTab = document.querySelector('.auth-tab[data-tab="signup"]');
            const signInForm = document.getElementById('signInForm');
            const signUpForm = document.getElementById('signUpForm');
            const modalTitle = document.getElementById('authModalTitle');
            const modalSubtitle = document.getElementById('authModalSubtitle');
            
            if (tab === 'signin') {
                // Switch to Sign In - ALWAYS show login form
                if (signInTab) signInTab.classList.add('active');
                if (signUpTab) signUpTab.classList.remove('active');
                if (signInForm) signInForm.classList.add('active');
                if (signUpForm) signUpForm.classList.remove('active');
                
                // CRITICAL: Hide signup steps
                const step1 = document.getElementById('signUpStep1');
                const step2 = document.getElementById('signUpStep2');
                if (step1) step1.style.display = 'none';
                if (step2) step2.style.display = 'none';
                
                if (modalTitle) modalTitle.textContent = 'UTOPIA X 로그인';
                if (modalSubtitle) modalSubtitle.textContent = '이메일로 간편하게 시작하세요';
                
                console.log('✅ Switched to Sign In tab');
            } else if (tab === 'signup') {
                // Use dedicated signup function for proper initialization
                console.log('🔄 Calling openSignupModal() for proper step initialization');
                if (typeof window.openSignupModal === 'function') {
                    window.openSignupModal();
                } else {
                    // Fallback if function not loaded yet
                    if (signInTab) signInTab.classList.remove('active');
                    if (signUpTab) signUpTab.classList.add('active');
                    if (signInForm) signInForm.classList.remove('active');
                    if (signUpForm) signUpForm.classList.add('active');
                    
                    if (modalTitle) modalTitle.textContent = '회원가입';
                    if (modalSubtitle) modalSubtitle.textContent = '유형을 선택해주세요';
                    
                    const signUpStep1 = document.getElementById('signUpStep1');
                    const signUpStep2 = document.getElementById('signUpStep2');
                    
                    if (signUpStep1) signUpStep1.style.display = 'block';
                    if (signUpStep2) signUpStep2.style.display = 'none';
                }
            }
        };
        
        // Debug: Check localStorage
        console.log('💾 Mock Users in localStorage:', localStorage.getItem('mockUsers'));
        
        // Debug: Test login function availability
        setTimeout(() => {
            console.log('🔍 Checking auth functions...');
            console.log('  - signIn:', typeof signIn);
            console.log('  - signUp:', typeof signUp);
            console.log('  - initSupabase:', typeof initSupabase);
        }, 2000);
        
        // =====================================
        // Chat Functions for Dancer Profiles
        // =====================================
        
        /**
         * Open 1:1 chat with dancer from profile
         * @param {string} dancerId - Dancer's user ID
         * @param {string} dancerName - Dancer's name
         * @param {string} dancerEmail - Dancer's email
         */
        window.openChatWithDancer = async function(dancerId, dancerName, dancerEmail) {
            console.log('💬 Opening chat with dancer:', dancerName, dancerId);
            
            // Check if user is logged in
            const userEmail = sessionStorage.getItem('userEmail');
            if (!userEmail || userEmail === 'Login') {
                showToast('로그인이 필요한 서비스입니다', 'info');
                
                // Open login modal if available
                if (typeof UIModule !== 'undefined' && UIModule.openModal) {
                    UIModule.openModal('loginModal');
                }
                return;
            }
            
            // Check if ChatModule is loaded
            if (typeof ChatModule === 'undefined') {
                console.error('❌ ChatModule not loaded');
                showToast('채팅 시스템을 불러올 수 없습니다', 'error');
                return;
            }
            
            // Initialize ChatModule if needed
            if (!ChatModule.currentUserId) {
                const success = await ChatModule.init();
                if (!success) {
                    showToast('채팅 시스템을 초기화할 수 없습니다', 'error');
                    return;
                }
            }
            
            // Open chat
            await ChatModule.openChatWith(dancerId, dancerName, dancerEmail);
        };
        
        console.log('✅ Chat functions loaded');
    </script>
    
    <!-- Chat Module (Only load if needed) -->
    <script src="js/chat.js"></script>
    
    <!-- Infinite Slider -->
    <script src="js/brand-slider.js"></script>
</body>
</html>
